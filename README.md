![12fb0df649a54c6a69d9fd2f07ffd26e](https://github.com/user-attachments/assets/4b4c967a-ac6d-4e4b-b758-3b3d16089733)

**What?**
The repo contains two python scripts. One for generating diffuse field frequency response data from HRIR SOFA file, exported as CSV and/or PNG plot. The other one is for applying a parametric EQ txt generated by [Room EQ Wizard](https://www.roomeqwizard.com/) (recommended) or [AutoEQ](https://autoeq.app/). Only parametric EQ is supported at the moment.
This is mainly for my own use. But maybe this is going to benefit other [APL Virtuoso](https://apl-hud.com/product/virtuoso/) users or other binaural audio software users that are trying to find a way to apply "Diffuse Field Equalization" or "Diffuse Field Response Flattening" to SOFA files, therefore I decided to share it.

With these scripts, a lot more SOFA files from [openly available datasets](https://www.sofaconventions.org/mediawiki/index.php/Files) are now easier to use.

**How?**
- Download [this repo](https://github.com/EaryChow/HRIR-SOFA-Equalizer/archive/refs/heads/main.zip)
- Install Python 3.9 and an IDE of your choice
- Command Prompt run `pip install sofar numpy scipy pathlib autoeq matplotlib`
- Put the HRIR SOFA file in the `input` folder of the measurement script
- Open the measurement script with the IDE, run the script
- Follow the GUI prompt, must export CSV, check PNG export as well if you need to look at the plot. 
- Export CSV of both left and right channels if you need to separately EQ the two. Otherwise export the average. Or export all three if not sure.
- Load the exported CSV in REW (Room EQ Wizard) or AutoEQ. Will use REW as example here.
- After drag and drop import, open the EQ page by clicking the EQ button in the upper menu.
- Chose generic manufacturer and model, then configure the settings, here is my settings for reference:
![image](https://github.com/user-attachments/assets/917c26a6-09db-4e39-9071-04f8a5491370)
- Export filter settings as text txt file, if you need a preamp, you can check the headroom value in the filter settings, manually add the negative of that number to the txt file as a line like this: Preamp: -9.2 db
- If you are EQing left and right channels separately, repeat the REW process on the other channel to generate a second EQ txt file.
- copy the SOFA file and the REW-exported EQ txt files to the EQ script's `input` folder.
- Run the EQ script, follow the prompt.
- Copy the exported EQ_applied SOFA file back to measurement script's `input` folder, run the measurement script and export PNG for checking the post EQ frequency response.
